/* Autogenerated Code */
package gsht;

import org.State;
import org.Transition;
import java.util.ArrayList;
import java.util.HashMap;


public class ThreeStates {
	
	private State currentState;
	private HashMap<String, Object> globalProps = new HashMap<>() {
		{
		put("Status", "Initial State");
		}
	};
	
	private ArrayList<String> events = new ArrayList<>() {
		{
			add("GoToState1");
			add("GoToState2");
			add("GoToState3");
		}
	};
	
	private HashMap<String, State> states = new HashMap<>() {
		{
			put("State1", new State() {
				{
					setName("State1");
					addTransition("GoToState2", new Transition() {
						{
							setEvent("GoToState2");
							setToState("State2");
							createAssignment("Status", "State 2", true);
						}
					});
				}
			});
			put("State2", new State() {
				{
					setName("State2");
					addTransition("GoToState3", new Transition() {
						{
							setEvent("GoToState3");
							setToState("State3");
							createAssignment("Status", "State 3", true);
						}
					});
				}
			});
			put("State3", new State() {
				{
					setName("State3");
					addTransition("GoToState1", new Transition() {
						{
							setEvent("GoToState1");
							setToState("State1");
							createAssignment("Status", "State 1 again", true);
						}
					});
				}
			});
		}
	};
	
	public ThreeStates() {
		currentState = states.get("State1");
	}

    		public void processEvent(String event) {
        		printEvent(event);
        		currentState.setGlobalProps(new HashMap<>(globalProps));
        		String nextStateName = currentState.onEvent(event);
        		if (currentState.getGlobalPropsSize() > 0) {
            		this.globalProps = new HashMap<>(currentState.returnGlobalProps());
        		}
        		currentState = states.get(nextStateName);
        		printGlobalProps();
        		printCurrentState(currentState);
    		};

    		private void printEvent(String event) {
        		System.out.println();
        		System.out.println("==================================");
        		System.out.println(String.format("Processing event: '%s'...", event));
        		System.out.println("==================================");
        		System.out.println();
    		}

    		private void printGlobalProps() {
        		System.out.println("Global props:");
        		globalProps.entrySet().forEach(entry -> {
            		System.out.println(String.format("%s\t%s", entry.getKey(), entry.getValue().toString()));
        		});
        		System.out.println();
    		}

    		private void printCurrentState(State state) {
        		System.out.println(String.format("Current state: %s", state.getName()));
        		state.printState();
    		}
    		
}
